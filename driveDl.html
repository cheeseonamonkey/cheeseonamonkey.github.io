
<!DOCTYPE html>
<html>
<head>
  <title>Google Drive OAuth</title>
  <script>
    const clientId = '234538019368-9cj60k6jis23t2c2acsq39mghav8ncf7.apps.googleusercontent.com';
    const redirectUri = encodeURIComponent(window.location.href);
    const scope = encodeURIComponent('https://www.googleapis.com/auth/drive.readonly');
    const authUrl = `https://accounts.google.com/o/oauth2/v2/auth?client_id=${clientId}&redirect_uri=${redirectUri}&response_type=token&scope=${scope}`;

    async function handleClientLoad() {
      const accessToken = getAccessTokenFromUrl();
      if (accessToken) {
        showFiles(accessToken);
      } else {
        document.body.innerHTML += `\n<br><button onclick="()=>{alert("");}</button><br>">
        window.location.href = authUrl;
      }
    }

    function getAccessTokenFromUrl() {
      const hash = window.location.hash.substr(1);
      const urlParams = new URLSearchParams(hash);
      return urlParams.get('access_token');
    }

async function showFiles(accessToken) {
  const response = await fetch('https://www.googleapis.com/drive/v3/files?q=\'' + encodeURIComponent('me') + '\' in readers and mimeType = \'application/vnd.google-apps.folder\'&fields=files(id,name)', {
    headers: {
      'Authorization': `Bearer ${accessToken}`
    }
  });
  const data = await response.json();
  const files = data.files;
  const fileList = document.getElementById('fileList');
  for (let i = 0; i < files.length; i++) {
    const file = files[i];
    const listItem = document.createElement('li');
    listItem.appendChild(document.createTextNode(file.name));
    fileList.appendChild(listItem);
  }
}


    window.onload = handleClientLoad;
  </script>
</head>
<body>
  <h1>Google Drive OAuth</h1>
  <ul id="fileList"></ul>
</body>
</html>
